<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aditya Mahajan">
<meta name="dcterms.date" content="2025-04-24">
<meta name="description" content="Course Notes for ECSE 307 (McGill University)">

<title>7&nbsp; Routh-Hurwitz Stability Criterion – Linear Systems and Control</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./block-diagrams.html" rel="next">
<link href="./output-feedback.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-4379b0ccadffce622b03caf4c46266b3.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2273ddc98e28bcf7e1550d84726b362d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-fd5cdd387564c229e11e0838b268e228.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/nutshell-1.0.6/nutshell.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
// https://github.com/mathjax/MathJax/issues/2744#issuecomment-1658624747
// To fix the bug that uppercase unicode letters are shown in italic
window.MathJax = {
  startup: {
    ready() {
      const {RANGES} = MathJax._.core.MmlTree.OperatorDictionary;
      const {TEXCLASS} = MathJax._.core.MmlTree.MmlNode;
      RANGES.splice(4, 1,
        [0x0370, 0x0385, TEXCLASS.ORD, 'mi'],
        [0x0386, 0x3AB, TEXCLASS.ORD, 'mi', 'normal'],
        [0x03AC, 0x1A20, TEXCLASS.ORD, 'mi']
      );
      MathJax.startup.defaultReady();
    }
  },
  tex: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    tags: "ams",
    macros: {
      PR: "\\mathbb{P}",
      EXP: "\\mathbb{E}",
      IND: "\\mathbb{1}",
      ONES: "\\mathbb{1}",
      reals: "\\mathbb{R}",
      integers: "\\mathbb{Z}",
      BLANK: "\\mathfrak{E}",
      TRANS: "\\intercal",
      VEC: "\\operatorname{vec}",
      diag: "\\operatorname{diag}",
      ROWS: "\\operatorname{vec}",
      TR: "\\operatorname{Tr}",   
      SPAN: "\\operatorname{span}",   
      ALPHABET: ["\\mathcal{#1}", 1],
      MATRIX: ["\\begin{bmatrix} #1 \\end{bmatrix}", 1],
      DET: ["\\begin{vmatrix} #1 \\end{vmatrix}", 1],
      NORM: ["\\left\\lVert \\mathstrut #1 \\right\\rVert", 1],
      ABS: ["\\left\\lvert \\mathstrut #1 \\right\\rvert", 1],
      GRAD: "\\nabla",
      IP: ["\\left\\langle #1, #2 \\right\\rangle", 2],
      iddots: "\\mathinner{ \\kern1mu\\raise1pt{.} \\kern2mu\\raise4pt{.} \\kern2mu\\raise7pt{\\Rule{0pt}{7pt}{0pt}.} \\kern1mu}",
    },
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
};
</script>
<script async="" data-id="101261731" src="//static.getclicky.com/js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Linear Control Systems</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/adityam/linear-systems" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./routh-hurwitz.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Routh-Hurwitz Stability Criterion</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Outline</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./freq-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequency domain modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./state-space-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">State space models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./step-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Step Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix-exponential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Time response of state space models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./state-feedback.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pole placement via statement feedback</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./output-feedback.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">State observers and output feedback</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./routh-hurwitz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Routh-Hurwitz Stability Criterion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./block-diagrams.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Block diagrams</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./steady-state-errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Steady-state errors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bode-and-nyquist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Bode and Nyquist plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nyquist-stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Nyquist Stability Criterion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./safety-margins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Gain and Phase margins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lag-lead-compensators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Lag-lead compensators</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#generating-the-routh-array" id="toc-generating-the-routh-array" class="nav-link active" data-scroll-target="#generating-the-routh-array"><span class="header-section-number">7.1</span> Generating the Routh Array</a></li>
  <li><a href="#interpreting-the-routh-array" id="toc-interpreting-the-routh-array" class="nav-link" data-scroll-target="#interpreting-the-routh-array"><span class="header-section-number">7.2</span> Interpreting the Routh Array</a>
  <ul class="collapse">
  <li><a href="#an-optimization" id="toc-an-optimization" class="nav-link" data-scroll-target="#an-optimization"><span class="header-section-number">7.2.1</span> An optimization</a></li>
  </ul></li>
  <li><a href="#special-cases-zero-in-the-first-column" id="toc-special-cases-zero-in-the-first-column" class="nav-link" data-scroll-target="#special-cases-zero-in-the-first-column"><span class="header-section-number">7.3</span> Special cases: Zero in the first column</a>
  <ul class="collapse">
  <li><a href="#reciprocal-polynomial" id="toc-reciprocal-polynomial" class="nav-link" data-scroll-target="#reciprocal-polynomial"><span class="header-section-number">7.3.1</span> Reciprocal polynomial</a></li>
  </ul></li>
  <li><a href="#special-cases-entire-row-of-zeros" id="toc-special-cases-entire-row-of-zeros" class="nav-link" data-scroll-target="#special-cases-entire-row-of-zeros"><span class="header-section-number">7.4</span> Special cases: Entire row of zeros</a></li>
  <li><a href="#stability-in-state-space" id="toc-stability-in-state-space" class="nav-link" data-scroll-target="#stability-in-state-space"><span class="header-section-number">7.5</span> Stability in state space</a></li>
  <li><a href="#stable-design-via-routh-hurwitz" id="toc-stable-design-via-routh-hurwitz" class="nav-link" data-scroll-target="#stable-design-via-routh-hurwitz"><span class="header-section-number">7.6</span> Stable design via Routh-Hurwitz</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/adityam/linear-systems/edit/quarto/routh-hurwitz.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Routh-Hurwitz Stability Criterion</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://adityam.github.io">Aditya Mahajan</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="http://www.mcgill.ca/ece">
            McGill University
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Consider a unity feedback system as shown in <a href="nyquist-stability.html#fig-feedback" class="quarto-xref">Figure&nbsp;<span>11.1</span></a>. In such a setting, we are often interested in finding the values of <span class="math inline">\(K\)</span> for which the system is stable.</p>
<div id="fig-feedback" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feedback-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/svg/routh-hurwitz1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feedback-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Block diagram of a proportional controller
</figcaption>
</figure>
</div>
<div id="exm-PI" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.1</strong></span> Consider the system shown in <a href="nyquist-stability.html#fig-feedback" class="quarto-xref">Figure&nbsp;<span>11.1</span></a> with <span class="math display">\[ G(s) = \frac{1}{s-1}. \]</span> Find the values of <span class="math inline">\(K\)</span> for which the system is stable.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The closed-loop transfer function is given by <span class="math display">\[ T(s) = \frac{K G(s)}{1 + K G(s) } = \frac{K}{s - 1 + K}. \]</span> Thus, the closed-loop transfer function has a pole at <span class="math inline">\(1 - K\)</span>. The system is stable when all poles are in the OLHP, i.e., <span class="math inline">\(1 - K &lt; 0\)</span>. Thus, the system is stable for <span class="math display">\[ K &gt; 1. \]</span></p>
</div>
</div>
</div>
<p>In the above example, we could identify the roots of the closed loop transfer function and thereby determine the values of gain <span class="math inline">\(K\)</span> for which the system is stable. However, we can only factorize lower order polynomials; for polynomials with degree greater than <span class="math inline">\(t\)</span>, we need to resort to numerical methods. Doing so, makes it difficult to find the range of values of <span class="math inline">\(K\)</span> for which a polynomial is stable.</p>
<p>However, for determine the stability of a system, we don’t need to find the roots of the denominator polynomial; we simply need to verify that all the roots are in the OLHP. The following result shows that we can determine if roots lie in the ORHP without factorizing a polynomial.</p>
<div id="thm-factorize" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.1</strong></span> A necessary condition for a polynomial to be stable is that all the coefficients have the same sign (positive or negative)</p>
</div>
<p>But this is a necessary condition but not a sufficient condition. So, we know that the polynomial <span class="math display">\[ D(s) = s^5 + 4 s^4 + 10s^3 - s^2 + 2 s + 1\]</span> is unstable because one of the coefficients are negative. Moreover, we know that the polynomial <span class="math display">\[ D(s) = s^4 + 4s^3 + s + 1\]</span> is unstable because the coefficient of the <span class="math inline">\(s^2\)</span> term is <span class="math inline">\(0\)</span>. But this necessary condition doesn’t tell us if <span class="math display">\[ D(s) = s^5 + 4 s^4 + 10s^3 + s^2 + 2 s + 1\]</span> is stable or not.</p>
<p>The Routh-Hurwitz criterion is a simple algebraic procedure which determines whether a polynomial is stable. The first step is generating what is called a Routh Array.</p>
<section id="generating-the-routh-array" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="generating-the-routh-array"><span class="header-section-number">7.1</span> Generating the Routh Array</h2>
<p>Consider a polynomial <span class="math display">\[ D(s) = a_n s^n + \cdots + a_0. \]</span></p>
<p>The Routh array is a (non-rectangular) array with <span class="math inline">\(n+1\)</span> rows, indexed by <span class="math inline">\(s^n\)</span>, <span class="math inline">\(s^{n-1}\)</span>, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(s^0\)</span>.</p>
<ul>
<li><p><strong>Step 1.</strong> Fill the first two rows of the Routh array with the coefficients of <span class="math inline">\(D(s)\)</span> going in the zigzag pattern as shown below. We stop when we have used all the coefficients. Any unfilled entries in the Routh array are assumed to be zero.</p>
<table class="routharray-simple" align="center">
<tbody><tr>
<td>
<p><span class="math inline">\(s^n\)</span></p>
</td>
<td>
<p><span class="math inline">\(a_{n}\)</span></p>
</td>
<td>
<p><span class="math inline">\(a_{n-2}\)</span></p>
</td>
<td>
<p><span class="math inline">\(\cdots\)</span></p>
</td>
</tr>
<tr>
<td>
<p><span class="math inline">\(s^{n-1}\)</span></p>
</td>
<td>
<p><span class="math inline">\(a_{n-1}\)</span></p>
</td>
<td>
<p><span class="math inline">\(a_{n-3}\)</span></p>
</td>
<td>
<p><span class="math inline">\(\cdots\)</span></p>
</td>
</tr>
</tbody></table></li>
<li><p><strong>Step 2.</strong> This is a recursive step, where we take two filled rows, say row <span class="math inline">\(s^{m+2}\)</span> and <span class="math inline">\(s^m\)</span> and use that to fill row <span class="math inline">\(s^m\)</span>, for all <span class="math inline">\(m \in \{n-2, \dots, 0\}\)</span>. Each entry is the negative determinant of a <span class="math inline">\(2 \times 2\)</span> matrix constructed from the entries in the previous two rows (i.e., row <span class="math inline">\(s^{m+2}\)</span> and <span class="math inline">\(s^{m+1}\)</span> when we are filling in row <span class="math inline">\(s^m\)</span>) divided by the first entry in row <span class="math inline">\(s^{m+1}\)</span> (<strong>provided that entry is not zero!</strong>). The first column of <span class="math inline">\(2 \times 2\)</span> matrix is the first column of the previous two rows; the second column of the <span class="math inline">\(2 \times 2\)</span> matrix is the columns above and to the right.</p>
<table class="routharray-simple" align="center">
<tbody><tr>
<td>
<p><span class="math inline">\(s^{m+2}\)</span></p>
</td>
<td>
<p><span class="math inline">\(b_{1}\)</span></p>
</td>
<td>
<p><span class="math inline">\(b_{2}\)</span></p>
</td>
<td>
<p><span class="math inline">\(\cdots\)</span></p>
</td>
</tr>
<tr>
<td>
<p><span class="math inline">\(s^{m+1}\)</span></p>
</td>
<td>
<p><span class="math inline">\(c_1\)</span></p>
</td>
<td>
<p><span class="math inline">\(c_2\)</span></p>
</td>
<td>
<p><span class="math inline">\(\cdots\)</span></p>
</td>
</tr>
<tr>
<td>
<p><span class="math inline">\(s^{m}\)</span></p>
</td>
<td>
<p><span class="math inline">\(-\dfrac{\DET{b_1 &amp; b_2 \\ c_1 &amp; c_2}}{c_1}\)</span></p>
</td>
<td>
<p><span class="math inline">\(-\dfrac{\DET{b_1 &amp; b_3 \\ c_1 &amp; c_3}}{c_1}\)</span></p>
</td>
<td>
<p><span class="math inline">\(\cdots\)</span></p>
</td>
</tr>
</tbody></table>
<p>Note that in each row, we eventually end up with zeros at which time we stop filling the row. We repeat this procedure until we have filled all rows until row <span class="math inline">\(s^0\)</span>.</p></li>
</ul>
<p>We always follow the above method to fill in the Routh array, irrespective of the size of the polynomial. We illustrate this via some examples.</p>
<div id="exm-Routh-Hurwitz-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.2</strong></span> Find the Routh Array of <span class="math display">\[ D(s) = s^4 + 2 s^3 + 3 s^2 + 4s + 5. \]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We follow the procedure described above. The first column of the table is highlight.</p>
<div id="a87b0e9d" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="29">
<table class="routharray"><tbody><tr><td>$s^{4}$</td><td>$1$</td><td>$3$</td><td>$5$</td></tr><tr><td>$s^{3}$</td><td>$2$</td><td>$4$</td></tr><tr><td>$s^{2}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 3 \\ 2 &amp; 4}}{2} = 1$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 5 \\ 2 &amp; 0}}{2} = 5$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ 2 &amp; 4 \\ 1 &amp; 5}}{1} = -6$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 5 \\ -6 &amp; 0}}{-6} = 5$</td></tr></tbody></table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interpreting-the-routh-array" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="interpreting-the-routh-array"><span class="header-section-number">7.2</span> Interpreting the Routh Array</h2>
<p>We start with the basic case when <strong>there is no zero in the first column</strong> (as is the case in <a href="#exm-Routh-Hurwitz-1" class="quarto-xref">Example&nbsp;<span>7.2</span></a>). In this case, we look at the first column and count the number of sign changes (which are highlighted by arrows above). For example, for <a href="#exm-Routh-Hurwitz-1" class="quarto-xref">Example&nbsp;<span>7.2</span></a>, we have two sign changes in the first column, as shown below.</p>
<!-- TODO: Add figure -->
<p>When there are no zeros in the first column, the polynomial has no roots on the <span class="math inline">\(j ω\)</span>-axis. Moreover,</p>
<ul>
<li>No.&nbsp;of roots in the ORHP = no. of sign changes</li>
<li>No.&nbsp;of roots in the OLHP = degree of polynomial <span class="math inline">\(-\)</span> no. of sign changes.</li>
</ul>
<p>So, for <a href="#exm-Routh-Hurwitz-1" class="quarto-xref">Example&nbsp;<span>7.2</span></a>, we have</p>
<ul>
<li>No.&nbsp;of roots in the ORHP = 2 (no. of sign changes)</li>
<li>No.&nbsp;of roots in the OLPH = 4 (degree of polynomial) <span class="math inline">\(-\)</span> 2 (no. of sign changes) = 2.</li>
</ul>
<p>We can verify this by factorizing <span class="math inline">\(D(s)\)</span>, which gives</p>
<div id="0320ba46" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>], <span class="op">:</span>s)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"D(s) = "</span>, D)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">roots</span>(D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>D(s) = 5 + 4*s + 3*s^2 + 2*s^3 + s^4</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>4-element Vector{ComplexF64}:
 -1.2878154795576484 - 0.8578967583284913im
 -1.2878154795576484 + 0.8578967583284913im
  0.2878154795576478 - 1.416093080171908im
  0.2878154795576478 + 1.416093080171908im</code></pre>
</div>
</div>
<div id="exm-Routh-Hurwitz-2" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.3</strong></span> Find the location of the poles of a TF with with denominator given by <span class="math display">\[ D(s) = s^4 + 5 s^3 + s^2 + 10s + 1. \]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first compute the Routh Array</p>
<div id="7750f84d" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="31">
<table class="routharray"><tbody><tr><td>$s^{4}$</td><td>$1$</td><td>$1$</td><td>$1$</td></tr><tr><td>$s^{3}$</td><td>$5$</td><td>$10$</td></tr><tr><td>$s^{2}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 1 \\ 5 &amp; 10}}{5} = -1$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 1 \\ 5 &amp; 0}}{5} = 1$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ 5 &amp; 10 \\ -1 &amp; 1}}{-1} = 15$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ -1 &amp; 1 \\ 15 &amp; 0}}{15} = 1$</td></tr></tbody></table>
</div>
</div>
<p>We now look at the signs of the terms in the first column:</p>
<div id="ac80718b" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="32">
<table class="routhsigns"><thead><tr><td>Term</td><td>Sign</td></tr></thead><tbody><tr><td>$s^{4}$</td><td>$+$</td></tr><tr><td>$s^{3}$</td><td>$+$</td></tr><tr><td>$s^{2}$</td><td>$-$</td></tr><tr><td>$s^{1}$</td><td>$+$</td></tr><tr><td>$s^{0}$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>Note that there are two sign changes in the first column. Thus, we have</p>
<ul>
<li>No.&nbsp;of roots in ORHP = 2 (no. of sign changes)</li>
<li>No.&nbsp;of roots in OLHP = 4 (degree of poly) <span class="math inline">\(-\)</span> 2 (no. of sign changes) = 2.</li>
</ul>
<p>We can verify this by factorizing <span class="math inline">\(D(s)\)</span>, which gives</p>
<div id="49d3f852" class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>D(s) = 1 + 10*s + s^2 + 5*s^3 + s^4</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>4-element Vector{ComplexF64}:
   -5.173143012444715 + 0.0im
 -0.10051275725870919 + 0.0im
  0.13682788485171066 - 1.3800281123446885im
  0.13682788485171066 + 1.3800281123446885im</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="an-optimization" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="an-optimization"><span class="header-section-number">7.2.1</span> An optimization</h3>
<p>Since we only care about the signs of the coefficient, we can multiply or divide all elements in a row by a positive number without changing the result. This can sometimes lead to simpler calculations.</p>
<div id="exm-Routh-Hurwitz-3" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.4</strong></span> Find the location of the poles of a TF with with denominator given by <span class="math display">\[ D(s) = s^6 + 4s^5 + 3s^4 + 2s^3 + s^2 + 4s + 4. \]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first compute the Routh Array</p>
<div id="7da8a54e" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display" data-execution_count="34">
<table class="routharray"><tbody><tr><td>$s^{6}$</td><td>$1$</td><td>$3$</td><td>$1$</td><td>$4$</td></tr><tr><td>$s^{5}$</td><td>$\cancel{4} 2$</td><td>$\cancel{2} 1$</td><td>$\cancel{4} 2$</td></tr><tr><td>$s^{4}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 3 \\ 2 &amp; 1}}{2} = \frac{5}{2}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 1 \\ 2 &amp; 2}}{2} = 0$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 4 \\ 2 &amp; 0}}{2} = 4$</td></tr><tr><td>$s^{3}$</td><td>$\displaystyle -\frac{\DET{ 2 &amp; 1 \\ \frac{5}{2} &amp; 0}}{\frac{5}{2}} = 1$</td><td>$\displaystyle -\frac{\DET{ 2 &amp; 2 \\ \frac{5}{2} &amp; 4}}{\frac{5}{2}} = \frac{-6}{5}$</td></tr><tr><td>$s^{2}$</td><td>$\displaystyle -\frac{\DET{ \frac{5}{2} &amp; 0 \\ 1 &amp; \frac{-6}{5}}}{1} = 3$</td><td>$\displaystyle -\frac{\DET{ \frac{5}{2} &amp; 4 \\ 1 &amp; 0}}{1} = 4$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; \frac{-6}{5} \\ 3 &amp; 4}}{3} = \frac{-38}{15}$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ 3 &amp; 4 \\ \frac{-38}{15} &amp; 0}}{\frac{-38}{15}} = 4$</td></tr></tbody></table>
</div>
</div>
<p>We now look at the signs of the terms in the first column:</p>
<div id="695b2756" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display" data-execution_count="35">
<table class="routhsigns"><thead><tr><td>Term</td><td>Sign</td></tr></thead><tbody><tr><td>$s^{6}$</td><td>$+$</td></tr><tr><td>$s^{5}$</td><td>$+$</td></tr><tr><td>$s^{4}$</td><td>$+$</td></tr><tr><td>$s^{3}$</td><td>$+$</td></tr><tr><td>$s^{2}$</td><td>$+$</td></tr><tr><td>$s^{1}$</td><td>$-$</td></tr><tr><td>$s^{0}$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>Note that there are two sign changes in the first column. Thus, we have</p>
<ul>
<li>No.&nbsp;of roots in ORHP = 2 (no. of sign changes)</li>
<li>No.&nbsp;of roots in OLHP = 6 (degree of poly) <span class="math inline">\(-\)</span> 2 (no. of sign changes) = 4.</li>
</ul>
<p>We can verify this by factorizing <span class="math inline">\(D(s)\)</span>, which gives</p>
<div id="ab3247d4" class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>D(s) = 4 + 4*s + s^2 + 2*s^3 + 3*s^4 + 4*s^5 + s^6</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>6-element Vector{ComplexF64}:
 -3.2643574436966434 + 0.0im
 -0.8858022358397655 + 0.0im
 -0.6045963281166988 - 0.993535028893593im
 -0.6045963281166988 + 0.993535028893593im
  0.6796761678849015 - 0.7488138087285154im
  0.6796761678849015 + 0.7488138087285154im</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="special-cases-zero-in-the-first-column" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="special-cases-zero-in-the-first-column"><span class="header-section-number">7.3</span> Special cases: Zero in the first column</h2>
<p>We cannot follow the usual method to construct the Routh array if there is zero in the first column. For example, consider <span class="math display">\[ D(s) = s^5 + 2s^4 + 3s^3 + 6s^2 + 5s + 3. \]</span></p>
<table class="routharray" align="center">
<tbody><tr>
<td>
<span class="math inline">\(s^5\)</span>
</td>
<td>
<span class="math inline">\(1\)</span>
</td>
<td>
<span class="math inline">\(3\)</span>
</td>
<td>
<span class="math inline">\(5\)</span>
</td>
</tr>
<tr>
<td>
<span class="math inline">\(s^4\)</span>
</td>
<td>
<span class="math inline">\(2\)</span>
</td>
<td>
<span class="math inline">\(6\)</span>
</td>
<td>
<span class="math inline">\(3\)</span>
</td>
</tr>
<tr>
<td>
<span class="math inline">\(s^3\)</span>
</td>
<td>
<span class="math inline">\(0\)</span>
</td>
<td>
<span class="math inline">\(7/2\)</span>
</td>
<td>
<span class="math inline">\(3\)</span>
</td>
</tr>
</tbody></table>
<p>If there is zero in the first column but the entire row is not zero, we proceed as follows</p>
<ul>
<li>Replace the zero in the first column by an <span class="math inline">\(ε\)</span> and continue to construct the Routh array as a function of <span class="math inline">\(ε\)</span>.</li>
<li>Count the number of sign changes as <span class="math inline">\(ε \to 0^{+}\)</span> (<span class="math inline">\(ε\)</span> goes to zero from above). Let this number be <span class="math inline">\(k_{+}\)</span>.</li>
<li>Count the number of sign changes as <span class="math inline">\(ε \to 0^{-}\)</span> (<span class="math inline">\(ε\)</span> goes to zero from below). Let this number be <span class="math inline">\(k_{-}\)</span>.</li>
</ul>
<p>Then, we have</p>
<ul>
<li>No.&nbsp;of roots in the ORHP = <span class="math inline">\(\min\{k_{+}, k_{-}\}\)</span></li>
<li>No.&nbsp;of roots on the <span class="math inline">\(j ω\)</span>-axis = <span class="math inline">\(|k_{+} - k_{-}|\)</span>.</li>
<li>No.&nbsp;of roots in the OLHP = <span class="math inline">\(\text{degree of polynomial} - \max\{k_{+}, k_{-}\}\)</span>.</li>
</ul>
<div id="exm-Routh-Hurwitz-zero-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.5</strong></span> Find the location of the poles of a TF with with denominator given by <span class="math display">\[ D(s) = s^5 + 2s^4 + 3s^3 + 6s^2 + 5s + 3. \]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first compute the Routh Array</p>
<div id="c778086c" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="37">
<table class="routharray"><tbody><tr><td>$s^{5}$</td><td>$1$</td><td>$3$</td><td>$5$</td></tr><tr><td>$s^{4}$</td><td>$2$</td><td>$6$</td><td>$3$</td></tr><tr><td>$s^{3}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 3 \\ 2 &amp; 6}}{2} = \cancel{0} \epsilon$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 5 \\ 2 &amp; 3}}{2} = \frac{7}{2}$</td></tr><tr><td>$s^{2}$</td><td>$\displaystyle -\frac{\DET{ 2 &amp; 6 \\ \epsilon &amp; \frac{7}{2}}}{\epsilon} = \frac{-7 + 6 \epsilon}{\epsilon}$</td><td>$\displaystyle -\frac{\DET{ 2 &amp; 3 \\ \epsilon &amp; 0}}{\epsilon} = 3$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ \epsilon &amp; \frac{7}{2} \\ \frac{-7 + 6 \epsilon}{\epsilon} &amp; 3}}{\frac{-7 + 6 \epsilon}{\epsilon}} = \frac{\frac{-49}{2} + 21 \epsilon - 3 \epsilon^{2}}{-7 + 6 \epsilon}$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ \frac{-7 + 6 \epsilon}{\epsilon} &amp; 3 \\ \frac{\frac{-49}{2} + 21 \epsilon - 3 \epsilon^{2}}{-7 + 6 \epsilon} &amp; 0}}{\frac{\frac{-49}{2} + 21 \epsilon - 3 \epsilon^{2}}{-7 + 6 \epsilon}} = 3$</td></tr></tbody></table>
</div>
</div>
<p>We now look at the signs of the terms in the first column:</p>
<div id="7e29fd48" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sign_changes</span>(RA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<table class="routhsigns"><thead><tr><td>Term</td><td>$ ε \to 0^{+}$</td><td>$ ε \to 0^{-}$</td></tr></thead><tbody><tr><td>$s^{5}$</td><td>$+$</td><td>$+$</td></tr><tr><td>$s^{4}$</td><td>$+$</td><td>$+$</td></tr><tr><td>$s^{3}$</td><td>$+$</td><td>$-$</td></tr><tr><td>$s^{2}$</td><td>$-$</td><td>$+$</td></tr><tr><td>$s^{1}$</td><td>$+$</td><td>$+$</td></tr><tr><td>$s^{0}$</td><td>$+$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>In both cases, we have two sign changes in the first column. Therefore, <span class="math inline">\(k_{+} = k_{-} = 2\)</span>. Hence, we have</p>
<ul>
<li>No.&nbsp;of roots in the ORHP = 2</li>
<li>No.&nbsp;of roots on the <span class="math inline">\(j ω\)</span>-axis = 0</li>
<li>No.&nbsp;of roots in the OLHP = <span class="math inline">\(5 - 2 = 3\)</span></li>
</ul>
<p>We can verify this by factorizing <span class="math inline">\(D(s)\)</span>, which gives</p>
<div id="68c9a886" class="cell" data-execution_count="12">
<div class="cell-output cell-output-stdout">
<pre><code>D(s) = 3 + 5*s + 6*s^2 + 3*s^3 + 2*s^4 + s^5</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>5-element Vector{ComplexF64}:
 -1.6680888389741944 + 0.0im
 -0.5088331416337463 - 0.7019951317695377im
 -0.5088331416337463 + 0.7019951317695377im
 0.34287756112084433 - 1.5082901611666297im
 0.34287756112084433 + 1.5082901611666297im</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="reciprocal-polynomial" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="reciprocal-polynomial"><span class="header-section-number">7.3.1</span> Reciprocal polynomial</h3>
<p>If we get a zero in the first column, we can follow another method but this method is not guaranteed to work. To understand this, we need the notion of a <strong>reciprocal polynomial</strong>: for a polynomial <span class="math inline">\(D(s)\)</span> of degree <span class="math inline">\(n\)</span>, the reciprocal polynomial is <span class="math inline">\(s^n D(\frac 1s)\)</span>. For instance, for <a href="#exm-Routh-Hurwitz-zero-1" class="quarto-xref">Example&nbsp;<span>7.5</span></a>, we have</p>
<p><span class="math display">\[\begin{align*}
s^5 D\left(\frac 1s\right) &amp;=
s^5 \left[ \frac{1}{s^5} + \frac{2}{s^4} + \frac{3}{s^3} + \frac{6}{s^2} + \frac{5}{s} + 3 \right] \\
&amp;= 3 s^5 + 5 s^4 + 6 s^3 + 3 s^2 + 2s + 1
\end{align*}\]</span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why look at the reciprocal polynomial.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Observe that if <span class="math inline">\(D(s)\)</span> factorizes as <span class="math display">\[
D(s) = (s+p_1)(s+p_2) \cdots (s+p_n)
\]</span> then the factorization of <span class="math inline">\(s^nD(\frac 1s)\)</span> is given by <span class="math display">\[\begin{align*}
s^n D(s) &amp;= s^n \left( \frac 1s + p_1 \right) \left( \frac 1s + p_2 \right) \cdots \left( \frac 1s + p_n \right) \\
&amp;= (p_1 p_2 \cdots p_n) \left(s + \frac 1{p_1} \right) \left( s + \frac{1}{p_2}\right) \cdots \left(s + \frac{1}{p_n} \right).
\end{align*}\]</span> Thus, if <span class="math inline">\(p_i\)</span> is a root of <span class="math inline">\(D(s)\)</span>, then <span class="math inline">\(\dfrac{1}{p_i}\)</span> is a root of <span class="math inline">\(s^n D(\frac 1s)\)</span>.</p>
<p>The key point is that <strong><span class="math inline">\(p_i\)</span> and <span class="math inline">\(1/p_i\)</span> have the same sign</strong>. In particular if <span class="math display">\[
p_i = a_i + j b_i \implies \frac {1}{p_i} = \frac{a}{|p_i|} - j\frac{ b_i}{|p_i|}
\]</span> So, the polynomial and its reciprocal have same number of roots in the OLHP, ORHP, and <span class="math inline">\(j ω\)</span>-axis.</p>
</div>
</div>
<div id="exm-Routh-Hurwitz-zero-2" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.6</strong></span> Solve <a href="#exm-Routh-Hurwitz-zero-1" class="quarto-xref">Example&nbsp;<span>7.5</span></a> using the reciprocal polynomial.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have already computed the reciprocal polynomial above. We now construct the Routh array</p>
<div id="8e51fab7" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="40">
<table class="routharray"><tbody><tr><td>$s^{5}$</td><td>$3$</td><td>$6$</td><td>$2$</td></tr><tr><td>$s^{4}$</td><td>$5$</td><td>$3$</td><td>$1$</td></tr><tr><td>$s^{3}$</td><td>$\displaystyle -\frac{\DET{ 3 &amp; 6 \\ 5 &amp; 3}}{5} = \frac{21}{5}$</td><td>$\displaystyle -\frac{\DET{ 3 &amp; 2 \\ 5 &amp; 1}}{5} = \frac{7}{5}$</td></tr><tr><td>$s^{2}$</td><td>$\displaystyle -\frac{\DET{ 5 &amp; 3 \\ \frac{21}{5} &amp; \frac{7}{5}}}{\frac{21}{5}} = \frac{4}{3}$</td><td>$\displaystyle -\frac{\DET{ 5 &amp; 1 \\ \frac{21}{5} &amp; 0}}{\frac{21}{5}} = 1$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ \frac{21}{5} &amp; \frac{7}{5} \\ \frac{4}{3} &amp; 1}}{\frac{4}{3}} = \frac{-7}{4}$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ \frac{4}{3} &amp; 1 \\ \frac{-7}{4} &amp; 0}}{\frac{-7}{4}} = 1$</td></tr></tbody></table>
</div>
</div>
<p>We now look at the signs of the terms in the first column:</p>
<div id="7a059a46" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="41">
<table class="routhsigns"><thead><tr><td>Term</td><td>Sign</td></tr></thead><tbody><tr><td>$s^{5}$</td><td>$+$</td></tr><tr><td>$s^{4}$</td><td>$+$</td></tr><tr><td>$s^{3}$</td><td>$+$</td></tr><tr><td>$s^{2}$</td><td>$+$</td></tr><tr><td>$s^{1}$</td><td>$-$</td></tr><tr><td>$s^{0}$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>Thus, we see that there are two sign changes in the first column. Therefore,</p>
<ul>
<li>No.&nbsp;of roots in the ORHP = 2 (no. of sign changes)</li>
<li>No.&nbsp;of roots in the OLHP = 5 (degree of polynomial) <span class="math inline">\(-\)</span> 2 (no. of sign changes) = 3. which matches with what we had observed in the solution of <a href="#exm-Routh-Hurwitz-zero-1" class="quarto-xref">Example&nbsp;<span>7.5</span></a>.</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="special-cases-entire-row-of-zeros" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="special-cases-entire-row-of-zeros"><span class="header-section-number">7.4</span> Special cases: Entire row of zeros</h2>
<p>Sometimes, we get an entire row of zero. For instance, consider <span class="math display">\[
D(s) = s^5 + 7s^4 + 6 s^3 + 42 s^2 + 8 s + 56.
\]</span></p>
<p>In this case, the Routh array ends with a row of zero.</p>
<table class="routharray-simple" align="center">
<tbody><tr>
<td>
<span class="math inline">\(s^5\)</span>
</td>
<td>
<span class="math inline">\(1\)</span>
</td>
<td>
<span class="math inline">\(6\)</span>
</td>
<td>
<span class="math inline">\(8\)</span>
</td>
</tr>
<tr>
<td>
<span class="math inline">\(s^4\)</span>
</td>
<td>
<span class="math inline">\(\cancel{7} 1\)</span>
</td>
<td>
<span class="math inline">\(\cancel{42} 6\)</span>
</td>
<td>
<span class="math inline">\(\cancel{56} 8\)</span>
</td>
</tr>
<tr>
<td>
<span class="math inline">\(s^3\)</span>
</td>
<td>
<span class="math inline">\(0\)</span>
</td>
<td>
<span class="math inline">\(0\)</span>
</td>
<td>
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody></table>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When do we get a row of zeros
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose the row <span class="math inline">\(s^{m-1}\)</span> is zero in the Routh array. This means that the polynomial <span class="math inline">\(P^m\)</span> (which is the polynomial above the row of zeros) divides <span class="math inline">\(D(s)\)</span>.</p>
<p>For instance, in the above example, row <span class="math inline">\(s^3\)</span> is zero. The above claim means that <span class="math display">\[
P_4(s) = s^4 + 6 s^2 + 8
\]</span> divides <span class="math inline">\(D(s)\)</span>. This is indeed the case and we can verify that <span class="math display">\[
D(s) = \underbrace{(s+7)}_{\text{remainder poly.}}
       \underbrace{(s^4 + 6s^2 + 8)}_{\text{divisor poly.}}.
\]</span></p>
</div>
</div>
<p>The rows that we have encountered until the row of all zeros corresponds to the remainder polynomial. We interpret is the same way we did the normal case.</p>
<p>Observe that the divisor polynomial is an <strong>even</strong> polynomial. A key feature of an even polynomial is that it has an equal number of roots in the OLHP and the ORHP. The number of sign changes is equal to the number of roots in the ORHP. So, the number of roots in OLHP are the same. The remaining roots must be on the <span class="math inline">\(j ω\)</span>-axis.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Roots of even polynomial
</div>
</div>
<div class="callout-body-container callout-body">
<p>An even polynomial has the same number of roots in the ORHP and OLHP.</p>
<p>Consider an even polynomial</p>
<p><span class="math display">\[P^{2m}(s) = a_{2m} s^{2m} + a_{2m -2 } s^{2m -2} + \cdots + a^0.\]</span></p>
<p>We can write this as a polynomial in <span class="math inline">\(z = s^2\)</span> as</p>
<p><span class="math display">\[ a_{2m} z^m + a_{2m -2} z^{m-1} + \cdots + a_0. \]</span></p>
<p>Let <span class="math inline">\(p_1, p_2, \dots, p_m\)</span> be the roots of this polynomial. Then, the roots of <span class="math inline">\(P^{2m}\)</span> are <span class="math inline">\(\pm \sqrt{p_1}, \pm \sqrt{p_2}, \dots, \pm \sqrt{p_m}\)</span>.</p>
<p>Now observe the following:</p>
<p>A. If <span class="math inline">\(p_i\)</span> is real and positive, then <span class="math inline">\(+ \sqrt{p_i}\)</span> is positive and <span class="math inline">\(- \sqrt{p_i}\)</span> is negative. Thus, one root is in the ORHP and one is in the OLHP.</p>
<p>B. If <span class="math inline">\(p_i\)</span> is real and negative, then <span class="math inline">\(\pm \sqrt{p_i} = \pm j \sqrt{|p_i|}\)</span>, which lie on the <span class="math inline">\(j ω\)</span>-axis. Thus, there are no roots in the ORHP or OLHP.</p>
<p>C. If <span class="math inline">\(p_i\)</span> is complex and say equal to <span class="math inline">\(a_i + j b_i\)</span>, then there must be another root <span class="math inline">\(a_i - j b_i\)</span>. Now let <span class="math inline">\(\pm (c_i + j d_i)\)</span> denote the square root of <span class="math inline">\(a_i + j b_i\)</span>. Then, the square roots of <span class="math inline">\(a_i - j b_i\)</span> are <span class="math inline">\(\pm (c_i - j d_i)\)</span>. Thus, out of the four roots, two are in the the ORHP and two are in the OLHP.</p>
<p>Thus, in all cases, no. of roots in the ORHP = no. of roots in the OLHP.</p>
<!-- TODO: Add a figure -->
</div>
</div>
<p>The rows that we have encountered until the row of all zeros corresponds to the remainder polynomial. We interpret is the same way we did the normal case.</p>
<p>We first compute the Routh Array</p>
<div id="1cbfe3cc" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="42">
<table class="routharray"><tbody><tr><td>$s^{5}$</td><td>$1$</td><td>$6$</td><td>$8$</td></tr><tr><td>$s^{4}$</td><td>$\cancel{7} 1$</td><td>$\cancel{42} 6$</td><td>$\cancel{56} 8$</td></tr><tr><td>$s^{3}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 6 \\ 1 &amp; 6}}{1} = \cancel{0} \cancel{4} 1$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 8 \\ 1 &amp; 8}}{1} = \cancel{0} \cancel{12} 3$</td></tr><tr><td>$s^{2}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 6 \\ 1 &amp; 3}}{1} = 3$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 8 \\ 1 &amp; 0}}{1} = 8$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 3 \\ 3 &amp; 8}}{3} = \frac{1}{3}$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ 3 &amp; 8 \\ \frac{1}{3} &amp; 0}}{\frac{1}{3}} = 8$</td></tr></tbody></table>
</div>
</div>
<p>We now look at the signs of the terms in the first column:</p>
<div id="1b9755cd" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="43">
<table class="routhsigns"><thead><tr><td>Term</td><td>Sign</td></tr></thead><tbody><tr><td>$s^{5}$</td><td>$+$</td></tr><tr><td>$s^{4}$</td><td>$+$</td></tr><tr><td>$s^{3}$</td><td>$+$</td></tr><tr><td>$s^{2}$</td><td>$+$</td></tr><tr><td>$s^{1}$</td><td>$+$</td></tr><tr><td>$s^{0}$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>Since we have a row of zeros, we split our analysis into two cases. The remainder polynomial, which is rows <span class="math inline">\(s^5\)</span> to <span class="math inline">\(s^4\)</span> and has no sign change, and the divisor polynomial, which is rows <span class="math inline">\(s^4\)</span> to <span class="math inline">\(s^0\)</span> and has no sign changes either. So, we have</p>
<table class="table-striped caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Polynomial</th>
<th style="text-align: center;">degree</th>
<th style="text-align: center;">no. of sign changes</th>
<th style="text-align: center;">ORHP</th>
<th style="text-align: center;">OLHP</th>
<th style="text-align: left;"><span class="math inline">\(j ω\)</span>-axis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Remainder</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Divisor</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(D(s)\)</span></td>
<td style="text-align: center;">5</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">4</td>
</tr>
</tbody>
</table>
<p>We can verify this by factorizing <span class="math inline">\(D(s)\)</span>, which gives (there are four roots on the <span class="math inline">\(j ω\)</span> axis but we get small error in the location of the roots due to numerical accuracy)</p>
<div id="739c83c8" class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>D(s) = 56 + 8*s + 42*s^2 + 6*s^3 + 7*s^4 + s^5</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>5-element Vector{ComplexF64}:
     -7.000000000000012 + 0.0im
  6.938893903907228e-17 - 1.414213562373094im
  6.938893903907228e-17 + 1.414213562373094im
 3.0531133177191805e-16 - 1.9999999999999993im
 3.0531133177191805e-16 + 1.9999999999999993im</code></pre>
</div>
</div>
<div id="exm-Routh-Hurwitz-row-zero-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.7</strong></span> Consider <span class="math display">\[
D(s) = (s^2 + 2)(s+2) = s^3 + s^2 + 2s + 2.
\]</span> Use Routh Hurwitz to find the location of the roots.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We write the Routh Array</p>
<div id="81923a48" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display" data-execution_count="45">
<table class="routharray"><tbody><tr><td>$s^{3}$</td><td>$1$</td><td>$2$</td></tr><tr><td>$s^{2}$</td><td>$1$</td><td>$2$</td></tr><tr><td>$s^{1}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 2 \\ 1 &amp; 2}}{1} = \cancel{0} 2$</td></tr><tr><td>$s^{0}$</td><td>$\displaystyle -\frac{\DET{ 1 &amp; 2 \\ 2 &amp; 0}}{2} = 2$</td></tr></tbody></table>
</div>
</div>
<p>We now look at the signs of the terms in the first column:</p>
<div id="d7b8e82d" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display" data-execution_count="46">
<table class="routhsigns"><thead><tr><td>Term</td><td>Sign</td></tr></thead><tbody><tr><td>$s^{3}$</td><td>$+$</td></tr><tr><td>$s^{2}$</td><td>$+$</td></tr><tr><td>$s^{1}$</td><td>$+$</td></tr><tr><td>$s^{0}$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>Since we have a row of zeros, we split our analysis into two cases. The remainder polynomial, which is rows <span class="math inline">\(s^3\)</span> to <span class="math inline">\(s^2\)</span> and has no sign change, and the divisor polynomial, which is rows <span class="math inline">\(s^2\)</span> to <span class="math inline">\(s^0\)</span> and has no sign changes either. So, we have</p>
<table class="table-striped caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Polynomial</th>
<th style="text-align: center;">degree</th>
<th style="text-align: center;">no. of sign changes</th>
<th style="text-align: center;">ORHP</th>
<th style="text-align: center;">OLHP</th>
<th style="text-align: left;"><span class="math inline">\(j ω\)</span>-axis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Remainder</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Divisor</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(D(s)\)</span></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="stability-in-state-space" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="stability-in-state-space"><span class="header-section-number">7.5</span> Stability in state space</h2>
<p>So far, we have examined stability of the TF. But we can use Routh-Hurwitz method to determine stability of state-space models as well. For example, consider a SSM <span class="math display">\[
  A = \MATRIX{0 &amp; 0 &amp; 1 \\ 1 &amp; 0 &amp; 1 \\ -10 &amp; -5 &amp; -2},
  \quad
  B = \MATRIX{10 \\ 0 \\ 0},
  \quad
  C = \MATRIX{1 &amp; 0 &amp; 0}.
\]</span> The denominator of the TF <span class="math inline">\(C(sI - A)^{-1}B\)</span> is the characteristic polynomial of <span class="math inline">\(A\)</span> given by <span class="math display">\[\begin{align*}
\det(sI - A) &amp;= \DET{s &amp; 0 &amp; -1 \\ -1 &amp; s &amp; -1 \\ 10 &amp; 5 &amp; s + 2}
\\
&amp;= s \DET{s &amp; -1 \\ 5 &amp; s + 2} -1 \DET{-1 &amp; -1 \\ s &amp; 5}
\\
&amp;= s^3 + 2 s^2 + 15s + 5
\end{align*}\]</span></p>
<p>We can determine if the SSM is stable by checking the stability of the characteristic polynomial of <span class="math inline">\(A\)</span>. In this instance, we have</p>
<div id="459f6bba" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="47">
<table class="routharray caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>$s^{3}$</td>
<td>$1$</td>
<td>$15$</td>
</tr>
<tr class="even">
<td>$s^{2}$</td>
<td>$2$</td>
<td>$5$</td>
</tr>
<tr class="odd">
<td>$s^{1}$</td>
<td>$\displaystyle -\frac{\DET{ 1 &amp; 15 \\ 2 &amp; 5}}{2} = \frac{25}{2}$</td>
<td></td>
</tr>
<tr class="even">
<td>$s^{0}$</td>
<td>$\displaystyle -\frac{\DET{ 2 &amp; 5 \\ \frac{25}{2} &amp; 0}}{\frac{25}{2}} = 5$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We now look at the sign of the terms in the first column:</p>
<div id="6d0ab5b9" class="cell" data-execution_count="21">
<div class="cell-output cell-output-display" data-execution_count="48">
<table class="routhsigns"><thead><tr><td>Term</td><td>Sign</td></tr></thead><tbody><tr><td>$s^{3}$</td><td>$+$</td></tr><tr><td>$s^{2}$</td><td>$+$</td></tr><tr><td>$s^{1}$</td><td>$+$</td></tr><tr><td>$s^{0}$</td><td>$+$</td></tr></tbody></table>
</div>
</div>
<p>Since there are no sign changes, the system is stable!</p>
</section>
<section id="stable-design-via-routh-hurwitz" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="stable-design-via-routh-hurwitz"><span class="header-section-number">7.6</span> Stable design via Routh-Hurwitz</h2>
<p>The Routh-Hurwitz criterion can be used to identify values of controller parameters for which a closed loop system is stable. We illustrate this via some examples.</p>
<div id="exm-stability-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.8</strong></span> Consider the system shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/svg/routh-hurwitz2.svg" class="img-fluid figure-img"></p>
<figcaption>A proportional controller</figcaption>
</figure>
</div>
<p>Find the value of <span class="math inline">\(K\)</span> for which the system is stable.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The closed loop transfer function is given by <span class="math display">\[
T(s) = \frac{K G(s)}{1 + K G(s)}
= \frac{K(s+1)}{s^3 + 5s^2 + (K-6)s + K
\]</span></p>
<p>Therefore, the Routh array is given by</p>
<div id="18e6e861" class="cell" data-execution_count="22">
<div class="cell-output cell-output-display" data-execution_count="49">
<table class="routharray caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>$s^{3}$</td>
<td>$1$</td>
<td>$-6 + K$</td>
</tr>
<tr class="even">
<td>$s^{2}$</td>
<td>$5$</td>
<td>$K$</td>
</tr>
<tr class="odd">
<td>$s^{1}$</td>
<td>$\displaystyle -\frac{\DET{ 1 &amp; -6 + K \\ 5 &amp; K}}{5} = -6 + \frac{4}{5} K$</td>
<td></td>
</tr>
<tr class="even">
<td>$s^{0}$</td>
<td>$\displaystyle -\frac{\DET{ 5 &amp; K \\ -6 + \frac{4}{5} K &amp; 0}}{-6 + \frac{4}{5} K} = K$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For stability, all terms in the first column must be positive. Thus, we have <span class="math display">\[
\dfrac{4K}{5} - 6 &gt; 0
\quad\text{and}\quad
K &gt; 0
\]</span> which is equivalent to <span class="math display">\[ K &gt; 7.5 \]</span></p>
</div>
</div>
</div>
<div id="exm-stability-2" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.9</strong></span> Consider the system shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/svg/routh-hurwitz3.svg" class="img-fluid figure-img"></p>
<figcaption>A proportional-integral (PI) controller</figcaption>
</figure>
</div>
<p>Find the values of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> for which the system is stable.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The closed loop transfer function is given by <span class="math display">\[
T(s) = \frac{\left(A + \dfrac{B}{s}\right) G(s)}{1 + \left(A + \dfrac{B}{s}\right)G(s)}
= \frac{As + B}{s^3 + 3s^2 + (A + 2)s + B}.
\]</span></p>
<p>Therefore, the Routh array is given by</p>
<div id="9dcf5879" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display" data-execution_count="50">
<table class="routharray caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>$s^{3}$</td>
<td>$1$</td>
<td>$2 + A$</td>
</tr>
<tr class="even">
<td>$s^{2}$</td>
<td>$3$</td>
<td>$B$</td>
</tr>
<tr class="odd">
<td>$s^{1}$</td>
<td>$\displaystyle -\frac{\DET{ 1 &amp; 2 + A \\ 3 &amp; B}}{3} = 2 + A - \frac{1}{3} B$</td>
<td></td>
</tr>
<tr class="even">
<td>$s^{0}$</td>
<td>$\displaystyle -\frac{\DET{ 3 &amp; B \\ 2 + A - \frac{1}{3} B &amp; 0}}{2 + A - \frac{1}{3} B} = B$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For stability, all terms in the first column must be positive. Thus, we have <span class="math display">\[
2 + A - \frac{1}{3}B &gt; 0
\quad\text{and}\quad
B &gt; 0.
\]</span></p>
</div>
</div>
</div>
<div id="exm-stability-3" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.10</strong></span> Consider the system shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/svg/routh-hurwitz4.svg" class="img-fluid figure-img"></p>
<figcaption>Another proportional controller</figcaption>
</figure>
</div>
<p>Find the value of <span class="math inline">\(K\)</span> for which the system is stable.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The closed loop transfer function is given by <span class="math display">\[
T(s) = \frac{K G(s)}{1 + K G(s)}
= \frac{6K}{s^3 + 6s^2 + 11s + 6(1+K)}
\]</span></p>
<p>Therefore, the Routh array is given by</p>
<div id="c949bc78" class="cell" data-execution_count="24">
<div class="cell-output cell-output-display" data-execution_count="51">
<table class="routharray caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>$s^{3}$</td>
<td>$1$</td>
<td>$11$</td>
</tr>
<tr class="even">
<td>$s^{2}$</td>
<td>$6$</td>
<td>$6 + 6 K$</td>
</tr>
<tr class="odd">
<td>$s^{1}$</td>
<td>$\displaystyle -\frac{\DET{ 1 &amp; 11 \\ 6 &amp; 6 + 6 K}}{6} = 10 - K$</td>
<td></td>
</tr>
<tr class="even">
<td>$s^{0}$</td>
<td>$\displaystyle -\frac{\DET{ 6 &amp; 6 + 6 K \\ 10 - K &amp; 0}}{10 - K} = 6 + 6 K$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For stability, all terms in the first column must be positive. Thus, we have <span class="math display">\[
10 - K &gt; 0
\quad\text{and}\quad
6(1+K) &gt; 0
\]</span> which is equivalent to <span class="math display">\[ -1 &lt; K &lt; 10 \]</span></p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/adityam\.github\.io\/linear-systems\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./output-feedback.html" class="pagination-link" aria-label="State observers and output feedback">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">State observers and output feedback</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./block-diagrams.html" class="pagination-link" aria-label="Block diagrams">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Block diagrams</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/adityam/linear-systems/edit/quarto/routh-hurwitz.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>